<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Tafel Editor Modular</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="index-style.css">
    
    <!-- Bibliotheken -->
    <script src="./tailwindcss.js"></script>
    <script src="./tinymce/tinymce.min.js" referrerpolicy="origin"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body class="text-gray-800">

    <!-- UI: Kopfzeile -->
    <div id="top-bar" class="fixed top-0 left-0 w-full h-12 bg-[#004f62] text-white flex items-center justify-between px-4 shadow-md z-50">
        <div class="flex items-center space-x-4">
            <span class="font-bold text-lg tracking-wide hidden md:inline">Kreidetafel+</span>
            <span id="app-version" class="text-xs bg-[#1f93b4] px-2 py-1 rounded text-white font-semibold italic">Lade...</span>
        </div>

        <div class="flex items-center space-x-2 sm:space-x-4">
            <div id="word-count" class="font-mono text-xs text-white bg-[#1f93b4] bg-opacity-30 px-2 py-1 rounded hidden lg:block">0 W√∂rter</div>
            <div id="window-dims" class="font-mono text-xs text-gray-300 hidden xl:block">-- x --</div>

            <button id="btn-groups" class="px-2 py-1 hover:bg-[#1f93b4] rounded flex items-center gap-1" title="Gruppen"><span class="text-sm font-medium">Gruppen</span></button>
            <button id="btn-iframe" class="px-2 py-1 hover:bg-[#1f93b4] rounded flex items-center gap-1" title="Tools"><span class="text-sm font-medium">Tools</span></button>
            <button id="btn-sketch" class="px-2 py-1 hover:bg-[#1f93b4] rounded flex items-center gap-1" title="Skizze"><span class="text-sm font-medium">Skizze</span></button>
            <button id="btn-math" class="px-2 py-1 hover:bg-[#1f93b4] rounded flex items-center gap-1" title="Mathe"><span class="text-sm font-medium">Mathe</span></button>
            <button id="btn-voice" class="px-2 py-1 hover:bg-[#1f93b4] rounded flex items-center gap-1" title="Vorlesen"><span class="text-sm font-medium">Vorlesen</span></button>
            <button id="btn-export-html" class="px-2 py-1 hover:bg-[#1f93b4] rounded ml-2" title="Export">üíæ</button>

            <div class="h-6 w-px bg-[#1f93b4] mx-2 hidden sm:block"></div>

            <button id="btn-help" class="flex items-center space-x-1 hover:text-[#1f93b4] transition-colors"><span class="hidden sm:inline">Hilfe</span></button>
        </div>
    </div>

    <main class="editor-wrapper mt-12">
        <div id="editor-box" class="editor-box">
            <textarea id="tafel-editor"></textarea>
        </div>
    </main>

    <div id="debug-console" style="display:none;">Bereit.</div>

    <!-- MODAL-CONTAINER -->
    <div id="help-modal" class="modal-overlay fixed inset-0 z-[200] hidden flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl p-6 relative">
            <button id="btn-close-help" class="absolute top-4 right-4 text-gray-400">‚úñ</button>
            <div id="help-content"></div>
        </div>
    </div>

    <div id="drawingModal" class="modal-overlay fixed inset-0 z-[100] hidden flex items-center justify-center">
        <div class="bg-white rounded-xl shadow-2xl w-[95%] max-w-4xl p-4 flex flex-col h-[90vh]">
            <div class="flex justify-between items-center mb-2 pb-2 border-b">
                <h3 class="text-lg font-bold text-[#004f62]">Skizze</h3>
                <div class="flex bg-gray-100 rounded p-1 gap-1">
                    <button id="tool-pen" class="px-2 py-1 rounded">‚úèÔ∏è</button>
                    <button id="tool-text" class="px-2 py-1 rounded">üÖ∞Ô∏è</button>
                    <button id="tool-eraser" class="px-2 py-1 rounded">üßΩ</button>
                    <button id="tool-line" class="px-2 py-1 rounded">üìè</button>
                    <button id="tool-rect" class="px-2 py-1 rounded">‚¨ú</button>
                    <button id="tool-circle" class="px-2 py-1 rounded">‚≠ï</button>
                </div>
                <button id="btn-close-sketch" class="text-gray-400">‚úñ</button>
            </div>
            <div class="relative bg-white border flex-grow overflow-hidden">
                <canvas id="sketchpad" class="w-full h-full"></canvas>
            </div>
            <div class="flex justify-between mt-2">
                <div class="flex gap-2 items-center">
                    <div id="colorPalette" class="flex gap-1"></div>
                    <div id="emojiPalette" class="flex gap-1"></div>
                    <input type="color" id="penColor" value="#000000">
                    <input type="range" id="penSize" min="1" max="20" value="2">
                </div>
                <button id="btn-insert-sketch" class="bg-[#1f93b4] text-white px-4 py-1 rounded font-bold">Einf√ºgen</button>
            </div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="snippets.js"></script>
    <script src="shortcuts.js"></script>
    <script src="changelog.js"></script>
    <script src="welcome.js"></script>
    <script src="tools.js"></script>
    <script src="hilfe-content.js"></script>
    <script src="korrektur.js"></script>
    <script src="math.js"></script> 
    <script src="voice.js"></script>
    <script src="skizze.js"></script>
    <script src="gruppen.js"></script> 
    <script src="iframe.js"></script> 
    <script src="editorUI.js"></script>
    <script src="hilfe.js"></script>
    <script src="hilfegruppe.js"></script>
    <script src="menuZeile.js"></script>
    <script src="logik-snippets.js"></script> <!-- ZUR√úCK ZUM ORIGINAL -->
    <script src="logik.js"></script>
    
    <script>
        window.addEventListener('load', () => {
             if (typeof HilfeModul !== 'undefined') HilfeModul.init();
             if (typeof ChangelogModul !== 'undefined' && ChangelogModul.history) {
                 document.getElementById('app-version').textContent = ChangelogModul.history[0].version;
             }
        });
    </script>
</body>
</html>